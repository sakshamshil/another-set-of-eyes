<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{% block title %}Another Set of Eyes{% endblock %}</title>

  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="/static/favicon.svg">

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=JetBrains+Mono:wght@400;500&family=Outfit:wght@400;500;600;700&display=swap"
    rel="stylesheet">

  <!-- HTMX -->
  <script src="https://unpkg.com/htmx.org@1.9.10"></script>

  <!-- Styles -->
  <link rel="stylesheet" href="/static/css/style.css">

  <!-- Syntax Highlighting -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>

  <!-- Markdown Rendering -->
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <!-- XSS Protection -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/dompurify/3.0.8/purify.min.js"></script>

  {% block head %}{% endblock %}
</head>

<body>
  <div class="app-shell">
    <!-- Top Bar & Tabs -->
    <header class="app-header">
      <div class="logo-area" onclick="TabManager.switch('dashboard')" style="cursor: pointer;">
        <svg class="logo-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="3"></circle>
          <path d="M12 21.5c-4.5 0-8.5-4-10-9.5 1.5-5.5 5.5-9.5 10-9.5s8.5 4 10 9.5c-1.5 5.5-5.5 9.5-10 9.5z"></path>
        </svg>
        <span class="logo-text">Eyes</span>
      </div>

      <nav class="tab-strip" id="tab-strip">
        <!-- Dashboard Tab (Always present) -->
        <div class="tab tab-home" data-tab-id="dashboard" onclick="TabManager.switch('dashboard')">
          <span class="tab-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="3" width="7" height="7"></rect>
              <rect x="14" y="3" width="7" height="7"></rect>
              <rect x="14" y="14" width="7" height="7"></rect>
              <rect x="3" y="14" width="7" height="7"></rect>
            </svg>
          </span>
          <span class="tab-title">Dashboard</span>
        </div>
        <!-- Dynamic Tabs will be injected here -->
      </nav>

      <div class="window-controls">
        <button class="tab-close-all" onclick="TabManager.closeAll(this)" title="Close all tabs (Alt+W)" aria-label="Close all tabs">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
            <line x1="20" y1="6" x2="8" y2="18" opacity="0.5"></line>
            <line x1="8" y1="6" x2="20" y2="18" opacity="0.5"></line>
          </svg>
        </button>
      </div>
    </header>

    <!-- Main Content Area -->
    <main class="app-main" id="app-main" data-initial-doc="{{ initial_doc_id or '' }}">
      <!-- Dashboard View (Default) -->
      <div class="tab-pane" id="pane-dashboard">
        {% block content %}{% endblock %}
      </div>
      <!-- Dynamic Panes will be injected here -->
    </main>
  </div>


  <!-- Manual Push Slide-out Panel -->
  <div id="push-panel" class="push-panel">
    <div class="push-panel-header">
      <h2 class="push-panel-title">New Document</h2>
      <button class="push-panel-close" onclick="DocumentCreator.close()">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
    </div>
    <div class="push-panel-body">
      <label class="push-label" for="push-title">Title</label>
      <input id="push-title" class="push-input" type="text" placeholder="My Document" autocomplete="off" />
      <label class="push-label" for="push-content">Content</label>
      <textarea id="push-content" class="push-textarea"
        placeholder="# Hello World&#10;&#10;Paste your markdown here..."></textarea>
    </div>
    <div class="push-panel-footer">
      <span id="push-error" class="push-error"></span>
      <button id="push-submit" class="btn-text btn-submit" onclick="DocumentCreator.submit()">Push Document</button>
    </div>
  </div>
  <div id="push-backdrop" class="push-backdrop" onclick="DocumentCreator.close()"></div>

  <script src="/static/js/app.js"></script>
</body>

</html>