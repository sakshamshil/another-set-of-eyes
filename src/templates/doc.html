{% extends "base.html" %}

{% block title %}{{ doc.title }}{% endblock %}

{% block head %}
<!-- Syntax highlighting -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>

<!-- Markdown rendering -->
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
{% endblock %}

{% block content %}
<div class="container doc-view">
  <header>
    <a href="/" class="back-link">&larr; Back</a>
    <h1>{{ doc.title }}</h1>
    <span class="status-badge status-{{ doc.status }}">{{ doc.status }}</span>
  </header>

  <article id="doc-content" class="markdown-body">
    <p class="loading">Rendering document...</p>
  </article>
</div>

<script>
  // Configure marked with syntax highlighting
  marked.setOptions({
    highlight: function(code, lang) {
      if (lang && hljs.getLanguage(lang)) {
        return hljs.highlight(code, { language: lang }).value;
      }
      return hljs.highlightAuto(code).value;
    },
    breaks: true,
    gfm: true
  });

  // Render markdown content
  const content = {{ doc.content | tojson }};
  document.getElementById('doc-content').innerHTML = marked.parse(content);
</script>
{% endblock %}
